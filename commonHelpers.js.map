{"version":3,"file":"commonHelpers.js","sources":["../src/js/api.js","../src/js/izitoast.js","../src/js/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_URL = 'https://pixabay.com/api/';\nconst KEY = '44493747-be1491bcf2f1874076b4c452a';\n\nexport async function searchImages(query, page = 1, limit = 30) {\n  const response = await axios.get(\n    `${API_URL}/?key=${KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&per_page=${limit}&page=${page}`\n  );\n\n  const hits = response.data.hits.map(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) => ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    })\n  );\n\n  return {\n    hits,\n    total: response.data.totalHits,\n  };\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport function displayMessage(\n  message,\n  color,\n  position = 'topRight',\n  timeout = 5000\n) {\n  iziToast.show({\n    message,\n    color,\n    position,\n    timeout,\n  });\n}\n\nexport function displayError(message) {\n  displayMessage(message, 'red');\n}\n\nexport function displayInfo(message) {\n  displayMessage(message, 'green');\n}\n","import debounce from 'lodash.debounce';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { searchImages } from './api.js';\nimport { displayError, displayInfo } from './izitoast.js';\n\nconst IMAGES_PER_PAGE = 30;\nlet lightBox;\nlet observer;\n\nfunction bindFormEvents() {\n    const form = document.getElementById('search-form');\n    if (!form) return;\n    form.addEventListener('submit', async event => {\n        event.preventDefault();\n        const searchQueryElement = [...form.elements].find(element => element.name === 'searchQuery');\n        if (!searchQueryElement) return;\n        const searchQuery = searchQueryElement.value;\n        await loadImages(searchQuery, 1, true);\n    });\n}\n\nfunction storeFormData({ query, page, total }) {\n    localStorage.setItem('query', query);\n    localStorage.setItem('page', page);\n    localStorage.setItem('total', total);\n}\n\nfunction getFormData() {\n    const query = localStorage.getItem('query');\n    const page = +localStorage.getItem('page');\n    const total = +localStorage.getItem('total');\n    return { query, page, total };\n}\n\nfunction bindScrollEvents() {\n    window.addEventListener('scroll', debounce(async () => {\n        const { scrollTop, scrollHeight, clientHeight } = document.documentElement;\n        if (scrollTop + clientHeight >= scrollHeight && hasMoreImages()) {\n            const { query, page } = getFormData();\n            await loadImages(query, page + 1);\n        }\n    }, 400), { passive: true });\n}\n\nasync function loadImages(query, page, replaceCards = false) {\n    if (!query?.trim()) {\n        clearGallery();\n        displayError('Query should not be empty.');\n        return;\n    }\n    try {\n        displayLoader();\n        const images = await searchImages(query, page, IMAGES_PER_PAGE);\n        storeFormData({ query, page, total: images.total });\n        renderCards(images.hits, replaceCards);\n        if (replaceCards) {\n            if (!images.total) {\n                displayError('Sorry, there are no images matching your search query. Please try again.');\n            } else {\n                displayInfo(`Hooray! We found ${images.total} images.`);\n            }\n        }\n        if (!hasMoreImages() && images.total) {\n            setupObserver();\n        }\n    } catch (e) {\n        clearGallery();\n        displayError('Sorry, error occurred. Please try again.');\n    } finally {\n        displayLoader(false);\n    }\n}\n\nfunction clearGallery() {\n    renderCards([], true);\n}\n\nfunction hasMoreImages() {\n    const { page, total } = getFormData();\n    return total > page * IMAGES_PER_PAGE;\n}\n\nfunction bindEvents() {\n    bindFormEvents();\n    bindScrollEvents();\n    lightBox = createSimpleLightBox();\n}\n\nfunction createCard(item) {\n    const { webformatURL, largeImageURL, tags, likes, views, comments, downloads } = item;\n    return `\n        <div class=\"photo-card flex flex-col items-center rounded-lg shadow-md overflow-hidden\">\n            <div class=\"image-container\">\n                <a href=\"${largeImageURL}\" class=\"block w-full h-64\">\n                    <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" class=\"w-full h-full object-cover\" />\n                </a>\n            </div>\n            <div class=\"info flex justify-between w-full p-2 bg-gray-100\">\n                <p class=\"info-item text-center\">\n                    <b>Likes</b>\n                    <span>${likes}</span>\n                </p>\n                <p class=\"info-item text-center\">\n                    <b>Views</b>\n                    <span>${views}</span>\n                </p>\n                <p class=\"info-item text-center\">\n                    <b>Comments</b>\n                    <span>${comments}</span>\n                </p>\n                <p class=\"info-item text-center\">\n                    <b>Downloads</b>\n                    <span>${downloads}</span>\n                </p>\n            </div>\n        </div>\n    `;\n}\n\nfunction renderCards(items, replace = true) {\n    const galleryElement = document.querySelector('.gallery');\n    if (!galleryElement) return;\n    const cardsHtml = items.map(item => createCard(item)).join('');\n    if (replace) {\n        galleryElement.innerHTML = cardsHtml;\n    } else {\n        galleryElement.insertAdjacentHTML('beforeend', cardsHtml);\n    }\n    lightBox?.refresh();\n    setupObserver();\n}\n\nfunction displayLoader(visible = true) {\n    const loader = document.querySelector('.loader');\n    if (!loader) return;\n    if (visible) {\n        loader.classList.remove('hidden');\n    } else {\n        loader.classList.add('hidden');\n    }\n}\n\nfunction createSimpleLightBox() {\n    return new SimpleLightbox('.gallery a', { captionDelay: 250, captionsData: 'alt' });\n}\n\nfunction setupObserver() {\n    const galleryElement = document.querySelector('.gallery');\n    const lastImage = galleryElement.lastElementChild;\n    if (observer) observer.disconnect();\n    observer = new IntersectionObserver(entries => {\n        entries.forEach(entry => {\n            if (entry.isIntersecting && !hasMoreImages()) {\n                displayError(\"We're sorry, but you've reached the end of search results.\");\n            }\n        });\n    }, { root: null, rootMargin: '0px', threshold: 0.1 });\n    if (lastImage) observer.observe(lastImage);\n}\n\nbindEvents();\n"],"names":["API_URL","KEY","searchImages","query","page","limit","response","axios","webformatURL","largeImageURL","tags","likes","views","comments","downloads","displayMessage","message","color","position","timeout","iziToast","displayError","displayInfo","IMAGES_PER_PAGE","lightBox","observer","bindFormEvents","form","event","searchQueryElement","element","searchQuery","loadImages","storeFormData","total","getFormData","bindScrollEvents","debounce","scrollTop","scrollHeight","clientHeight","hasMoreImages","replaceCards","clearGallery","displayLoader","images","renderCards","setupObserver","bindEvents","createSimpleLightBox","createCard","item","items","replace","galleryElement","cardsHtml","visible","loader","SimpleLightbox","lastImage","entries","entry"],"mappings":"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"}